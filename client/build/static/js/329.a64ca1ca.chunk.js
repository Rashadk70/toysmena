"use strict";(self.webpackChunktoysmena_client=self.webpackChunktoysmena_client||[]).push([[329],{329:(e,s,a)=>{a.r(s),a.d(s,{default:()=>z});var l=a(9950),n=a(3464),i=a(33),t=a(8170),r=a(3174),c=a(6491),o=a(9925),d=a(5979),h=a(3788),A=a(6101),u=a(3266),x=a(9739),j=a(226),m=a(6699),p=a(2053),v=a(2235),C=a(1320),y=a(5769),f=a(9780),g=a(9213),w=a(1671),S=a(4075),b=a(1413),U=a(5277),P=a(5333),k=a(1434),E=a(9715),L=a(379),R=a(3235),F=a(4414);const M=(0,R.A)((0,F.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12m8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8"}),"Block");var T=a(760);const D=["user","admin","seller"];function I(e){let{open:s,handleClose:a,user:m,handleSave:p}=e;const[v,C]=(0,l.useState)({name:"",email:"",role:"user",isActive:!0}),[y,f]=(0,l.useState)("");(0,l.useEffect)((()=>{C(m?{name:m.name,email:m.email,role:m.role,isActive:m.isActive}:{name:"",email:"",role:"user",isActive:!0})}),[m]);const g=e=>{C({...v,[e.target.name]:e.target.value})};return(0,F.jsxs)(n.A,{open:s,onClose:a,maxWidth:"sm",fullWidth:!0,children:[(0,F.jsx)(i.A,{children:m?"Edit User":"Add New User"}),(0,F.jsxs)(t.A,{children:[y&&(0,F.jsx)(r.A,{severity:"error",sx:{mb:2},children:y}),(0,F.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,F.jsx)(o.A,{name:"name",label:"Name",value:v.name,onChange:g,required:!0}),(0,F.jsx)(o.A,{name:"email",label:"Email",type:"email",value:v.email,onChange:g,required:!0}),(0,F.jsxs)(d.A,{children:[(0,F.jsx)(h.A,{children:"Role"}),(0,F.jsx)(A.A,{name:"role",value:v.role,onChange:g,label:"Role",children:D.map((e=>(0,F.jsx)(u.A,{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e)))})]}),(0,F.jsxs)(d.A,{children:[(0,F.jsx)(h.A,{children:"Status"}),(0,F.jsxs)(A.A,{name:"isActive",value:v.isActive,onChange:g,label:"Status",children:[(0,F.jsx)(u.A,{value:!0,children:"Active"}),(0,F.jsx)(u.A,{value:!1,children:"Inactive"})]})]})]})]}),(0,F.jsxs)(x.A,{children:[(0,F.jsx)(j.A,{onClick:a,children:"Cancel"}),(0,F.jsxs)(j.A,{onClick:()=>{v.name&&v.email?(p(v),a()):f("Please fill in all required fields")},variant:"contained",children:[m?"Update":"Add"," User"]})]})]})}const z=function(){const[e,s]=(0,l.useState)([]),[a,n]=(0,l.useState)(!0),[i,t]=(0,l.useState)(""),[x,R]=(0,l.useState)(0),[z,N]=(0,l.useState)(10),[O,q]=(0,l.useState)(!1),[J,W]=(0,l.useState)(null),[$,H]=(0,l.useState)(""),[V,_]=(0,l.useState)(""),B=async()=>{try{n(!0);const e=await fetch("/api/admin/users"),a=await e.json();a.success?s(a.users):t(a.message)}catch(e){t("Failed to fetch users")}finally{n(!1)}};(0,l.useEffect)((()=>{B()}),[]);const G=e.filter((e=>{const s=e.name.toLowerCase().includes($.toLowerCase())||e.email.toLowerCase().includes($.toLowerCase()),a=!V||e.role===V;return s&&a}));return a?(0,F.jsx)(m.A,{}):(0,F.jsxs)(c.A,{children:[(0,F.jsxs)(c.A,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[(0,F.jsx)(p.A,{variant:"h4",children:"Users"}),(0,F.jsx)(j.A,{variant:"contained",onClick:()=>{W(null),q(!0)},children:"Add User"})]}),i&&(0,F.jsx)(r.A,{severity:"error",sx:{mb:2},children:i}),(0,F.jsx)(v.A,{sx:{mb:2,p:2},children:(0,F.jsxs)(c.A,{sx:{display:"flex",gap:2},children:[(0,F.jsx)(o.A,{label:"Search Users",value:$,onChange:e=>H(e.target.value),InputProps:{startAdornment:(0,F.jsx)(E.A,{})}}),(0,F.jsxs)(d.A,{sx:{minWidth:200},children:[(0,F.jsx)(h.A,{children:"Filter by Role"}),(0,F.jsxs)(A.A,{value:V,onChange:e=>_(e.target.value),label:"Filter by Role",children:[(0,F.jsx)(u.A,{value:"",children:"All Roles"}),D.map((e=>(0,F.jsx)(u.A,{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e)))]})]})]})}),(0,F.jsxs)(C.A,{component:v.A,children:[(0,F.jsxs)(y.A,{children:[(0,F.jsx)(f.A,{children:(0,F.jsxs)(g.A,{children:[(0,F.jsx)(w.A,{children:"User"}),(0,F.jsx)(w.A,{children:"Email"}),(0,F.jsx)(w.A,{children:"Role"}),(0,F.jsx)(w.A,{children:"Status"}),(0,F.jsx)(w.A,{children:"Joined"}),(0,F.jsx)(w.A,{children:"Actions"})]})}),(0,F.jsx)(S.A,{children:G.slice(x*z,x*z+z).map((e=>(0,F.jsxs)(g.A,{children:[(0,F.jsx)(w.A,{children:(0,F.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,F.jsx)(b.A,{children:e.name.charAt(0)}),(0,F.jsx)(p.A,{children:e.name})]})}),(0,F.jsx)(w.A,{children:e.email}),(0,F.jsx)(w.A,{children:(0,F.jsx)(U.A,{label:e.role.charAt(0).toUpperCase()+e.role.slice(1),color:"admin"===e.role?"primary":"default"})}),(0,F.jsx)(w.A,{children:(0,F.jsx)(U.A,{label:e.isActive?"Active":"Inactive",color:e.isActive?"success":"error"})}),(0,F.jsx)(w.A,{children:new Date(e.createdAt).toLocaleDateString()}),(0,F.jsxs)(w.A,{children:[(0,F.jsx)(P.A,{color:"primary",onClick:()=>(e=>{W(e),q(!0)})(e),children:(0,F.jsx)(L.A,{})}),(0,F.jsx)(P.A,{color:e.isActive?"error":"success",onClick:()=>(async(e,s)=>{try{const a=await fetch(`/api/admin/users/${e}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!s})}),l=await a.json();l.success?B():t(l.message)}catch(a){t("Failed to update user status")}})(e.id,e.isActive),children:(0,F.jsx)(M,{})}),(0,F.jsx)(P.A,{color:"error",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this user?"))try{const s=await fetch(`/api/admin/users/${e}`,{method:"DELETE"}),a=await s.json();a.success?B():t(a.message)}catch(s){t("Failed to delete user")}})(e.id),children:(0,F.jsx)(T.A,{})})]})]},e.id)))})]}),(0,F.jsx)(k.A,{rowsPerPageOptions:[5,10,25],component:"div",count:G.length,rowsPerPage:z,page:x,onPageChange:(e,s)=>{R(s)},onRowsPerPageChange:e=>{N(parseInt(e.target.value,10)),R(0)}})]}),(0,F.jsx)(I,{open:O,handleClose:()=>q(!1),user:J,handleSave:async e=>{try{const s=J?`/api/admin/users/${J.id}`:"/api/admin/users",a=J?"PUT":"POST",l=await fetch(s,{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await l.json();n.success?B():t(n.message)}catch(s){t("Failed to save user")}}})]})}},379:(e,s,a)=>{a.d(s,{A:()=>i});var l=a(3235),n=a(4414);const i=(0,l.A)((0,n.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},760:(e,s,a)=>{a.d(s,{A:()=>i});var l=a(3235),n=a(4414);const i=(0,l.A)((0,n.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")}}]);