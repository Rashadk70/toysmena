"use strict";(self.webpackChunktoysmena_client=self.webpackChunktoysmena_client||[]).push([[398],{4398:(e,s,t)=>{t.r(s),t.d(s,{default:()=>N});var n=t(9950),r=t(8089),a=t(704),i=t(2053),l=t(6491),c=t(6639),d=t(226),o=t(6817),x=t(3266),h=t(3174),j=t(899),m=t(2235),u=t(1320),A=t(5769),y=t(9780),g=t(9213),p=t(1671),v=t(4075),b=t(1095),f=t(2847),L=t(3245),w=t(158),C=t(4813),S=t(6335),k=t(5102),D=t(6473),R=t(7360),B=t(4203),E=t(2528),F=t(294),O=t(5706),K=t(9196),T=t(9240),$=t(3935),I=t(4414);const P=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"];function U(e){let{title:s,value:t,percentage:n,trend:c,children:d}=e;return(0,I.jsx)(r.A,{children:(0,I.jsxs)(a.A,{children:[(0,I.jsx)(i.A,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:s}),(0,I.jsx)(i.A,{variant:"h4",component:"div",children:t}),(0,I.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",mt:1},children:[(0,I.jsxs)(i.A,{variant:"body2",color:"up"===c?"success.main":"error.main",children:[n,"%"]}),(0,I.jsx)(i.A,{variant:"body2",color:"text.secondary",sx:{ml:1},children:"vs last period"})]}),d]})})}const N=function(){const[e,s]=(0,n.useState)(!0),[t,r]=(0,n.useState)(""),[a,N]=(0,n.useState)("7d"),[V,z]=(0,n.useState)(null),[W,_]=(0,n.useState)({summary:{revenue:0,orders:0,customers:0,avgOrderValue:0},salesTrend:[],topProducts:[],categoryDistribution:[],customerSegments:[],revenueByLocation:[]});(0,n.useEffect)((()=>{H()}),[a]);const H=async()=>{try{s(!0);const e=await fetch(`/api/admin/analytics?timeRange=${a}`),t=await e.json();t.success?_(t.data):r(t.message)}catch(e){r("Failed to fetch analytics data")}finally{s(!1)}},q=e=>{e&&N(e),z(null)};return e?(0,I.jsx)(l.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:(0,I.jsx)(c.A,{})}):(0,I.jsxs)(l.A,{children:[(0,I.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[(0,I.jsx)(i.A,{variant:"h4",children:"Analytics"}),(0,I.jsxs)(l.A,{children:[(0,I.jsx)(d.A,{variant:"outlined",startIcon:(0,I.jsx)(K.A,{}),onClick:e=>{z(e.currentTarget)},sx:{mr:1},children:"7d"===a?"Last 7 Days":"30d"===a?"Last 30 Days":"90d"===a?"Last 90 Days":"Custom"}),(0,I.jsxs)(o.A,{anchorEl:V,open:Boolean(V),onClose:()=>q(),children:[(0,I.jsx)(x.A,{onClick:()=>q("7d"),children:"Last 7 Days"}),(0,I.jsx)(x.A,{onClick:()=>q("30d"),children:"Last 30 Days"}),(0,I.jsx)(x.A,{onClick:()=>q("90d"),children:"Last 90 Days"})]}),(0,I.jsx)(d.A,{variant:"outlined",startIcon:(0,I.jsx)(T.A,{}),onClick:H,sx:{mr:1},children:"Refresh"}),(0,I.jsx)(d.A,{variant:"contained",startIcon:(0,I.jsx)($.A,{}),onClick:async()=>{try{const e=await fetch(`/api/admin/analytics/export?timeRange=${a}`),s=await e.blob(),t=window.URL.createObjectURL(s),n=document.createElement("a");n.href=t,n.download=`analytics-report-${a}.xlsx`,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(t)}catch(e){r("Failed to export data")}},children:"Export Report"})]})]}),t&&(0,I.jsx)(h.A,{severity:"error",sx:{mb:3},children:t}),(0,I.jsxs)(j.Ay,{container:!0,spacing:3,sx:{mb:3},children:[(0,I.jsx)(j.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsx)(U,{title:"Total Revenue",value:`AED ${W.summary.revenue.toLocaleString()}`,percentage:12.5,trend:"up"})}),(0,I.jsx)(j.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsx)(U,{title:"Total Orders",value:W.summary.orders.toLocaleString(),percentage:8.3,trend:"up"})}),(0,I.jsx)(j.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsx)(U,{title:"New Customers",value:W.summary.customers.toLocaleString(),percentage:-2.4,trend:"down"})}),(0,I.jsx)(j.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsx)(U,{title:"Average Order Value",value:`AED ${W.summary.avgOrderValue.toLocaleString()}`,percentage:5.7,trend:"up"})})]}),(0,I.jsxs)(m.A,{sx:{p:3,mb:3},children:[(0,I.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"Sales Trend"}),(0,I.jsx)(b.u,{width:"100%",height:300,children:(0,I.jsxs)(f.b,{data:W.salesTrend,children:[(0,I.jsx)(L.d,{strokeDasharray:"3 3"}),(0,I.jsx)(w.W,{dataKey:"date"}),(0,I.jsx)(C.h,{}),(0,I.jsx)(S.m,{}),(0,I.jsx)(k.s,{}),(0,I.jsx)(D.N,{type:"monotone",dataKey:"revenue",stroke:"#8884d8",name:"Revenue"}),(0,I.jsx)(D.N,{type:"monotone",dataKey:"orders",stroke:"#82ca9d",name:"Orders"})]})})]}),(0,I.jsxs)(j.Ay,{container:!0,spacing:3,children:[(0,I.jsx)(j.Ay,{item:!0,xs:12,md:6,children:(0,I.jsxs)(m.A,{sx:{p:3,height:"100%"},children:[(0,I.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"Top Products"}),(0,I.jsx)(u.A,{children:(0,I.jsxs)(A.A,{size:"small",children:[(0,I.jsx)(y.A,{children:(0,I.jsxs)(g.A,{children:[(0,I.jsx)(p.A,{children:"Product"}),(0,I.jsx)(p.A,{align:"right",children:"Sales"}),(0,I.jsx)(p.A,{align:"right",children:"Revenue"})]})}),(0,I.jsx)(v.A,{children:W.topProducts.map((e=>(0,I.jsxs)(g.A,{children:[(0,I.jsx)(p.A,{children:e.name}),(0,I.jsx)(p.A,{align:"right",children:e.sales}),(0,I.jsxs)(p.A,{align:"right",children:["AED ",e.revenue.toLocaleString()]})]},e.id)))})]})})]})}),(0,I.jsx)(j.Ay,{item:!0,xs:12,md:6,children:(0,I.jsxs)(m.A,{sx:{p:3,height:"100%"},children:[(0,I.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"Sales by Category"}),(0,I.jsx)(b.u,{width:"100%",height:300,children:(0,I.jsxs)(R.r,{children:[(0,I.jsx)(B.F,{data:W.categoryDistribution,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:!0,children:W.categoryDistribution.map(((e,s)=>(0,I.jsx)(E.f,{fill:P[s%P.length]},`cell-${s}`)))}),(0,I.jsx)(S.m,{}),(0,I.jsx)(k.s,{})]})})]})}),(0,I.jsx)(j.Ay,{item:!0,xs:12,md:6,children:(0,I.jsxs)(m.A,{sx:{p:3,height:"100%"},children:[(0,I.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"Customer Segments"}),(0,I.jsx)(b.u,{width:"100%",height:300,children:(0,I.jsxs)(F.E,{data:W.customerSegments,children:[(0,I.jsx)(L.d,{strokeDasharray:"3 3"}),(0,I.jsx)(w.W,{dataKey:"name"}),(0,I.jsx)(C.h,{}),(0,I.jsx)(S.m,{}),(0,I.jsx)(k.s,{}),(0,I.jsx)(O.y,{dataKey:"value",fill:"#8884d8"})]})})]})}),(0,I.jsx)(j.Ay,{item:!0,xs:12,md:6,children:(0,I.jsxs)(m.A,{sx:{p:3,height:"100%"},children:[(0,I.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"Revenue by Location"}),(0,I.jsx)(u.A,{children:(0,I.jsxs)(A.A,{size:"small",children:[(0,I.jsx)(y.A,{children:(0,I.jsxs)(g.A,{children:[(0,I.jsx)(p.A,{children:"Location"}),(0,I.jsx)(p.A,{align:"right",children:"Orders"}),(0,I.jsx)(p.A,{align:"right",children:"Revenue"})]})}),(0,I.jsx)(v.A,{children:W.revenueByLocation.map((e=>(0,I.jsxs)(g.A,{children:[(0,I.jsx)(p.A,{children:e.name}),(0,I.jsx)(p.A,{align:"right",children:e.orders}),(0,I.jsxs)(p.A,{align:"right",children:["AED ",e.revenue.toLocaleString()]})]},e.id)))})]})})]})})]})]})}}}]);